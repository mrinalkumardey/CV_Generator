<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional CV Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --success-color: #2ecc71;
            --border-radius: 8px;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            flex: 1;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background-color: var(--primary-color);
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border-left: 5px solid var(--accent-color);
        }
        
        h1 {
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .tagline {
            font-style: italic;
            opacity: 0.9;
        }
        
        .app-container {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
            margin-bottom: 40px;
        }
        
        .form-container {
            flex: 1;
            min-width: 320px;
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 1px solid #e1e8ed;
        }
        
        .preview-container {
            flex: 1;
            min-width: 320px;
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow-y: auto;
            max-height: 850px;
            border: 1px solid #e1e8ed;
        }
        
        .section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }
        
        .section-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        h2 {
            color: var(--primary-color);
            font-size: 1.3rem;
            position: relative;
            padding-left: 15px;
        }
        
        h2:before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 5px;
            height: 20px;
            background-color: var(--accent-color);
            border-radius: 3px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: border 0.3s, box-shadow 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn-danger {
            background-color: #e74c3c;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-small {
            padding: 8px 12px;
            font-size: 0.9rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        /* CV Preview Styles */
        .cv-preview {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
            line-height: 1.6;
            padding: 0 10px;
        }
        
        .cv-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--dark-color) 100%);
            color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--accent-color);
        }
        
        .cv-name {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .cv-contact {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            font-size: 1rem;
            margin-top: 15px;
        }
        
        .cv-section {
            margin-bottom: 25px;
            page-break-inside: avoid;
        }
        
        .cv-section-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 8px;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .cv-item {
            margin-bottom: 20px;
            padding-left: 20px;
            position: relative;
        }
        
        .cv-item:before {
            content: "•";
            color: var(--accent-color);
            font-size: 1.5rem;
            position: absolute;
            left: 0;
            top: 0;
        }
        
        .cv-item-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--dark-color);
        }
        
        .cv-item-subtitle {
            color: #666;
            margin-bottom: 5px;
            font-style: italic;
        }
        
        .cv-item-date {
            color: #777;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }
        
        .cv-item-description {
            font-family: 'Georgia', serif;
            font-size: 0.95rem;
            color: #555;
            line-height: 1.5;
        }
        
        .cv-skills {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding-left: 20px;
        }
        
        .skill-tag {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #2980b9 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            position: relative;
            padding-left: 30px;
        }
        
        .skill-tag:before {
            content: "✓";
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: bold;
        }
        
        .education-item {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
            padding-left: 20px;
        }
        
        .education-item:before {
            content: "•";
            color: var(--accent-color);
            font-size: 1.5rem;
            position: absolute;
            left: 0;
        }
        
        .education-detail {
            flex: 1;
            min-width: 200px;
        }

        /* Footer styles for the generator page */
        .page-footer {
            margin-top: auto;
            padding: 20px;
            text-align: center;
            border-top: 2px solid var(--secondary-color);
            background: #f8f9fa;
            border-radius: var(--border-radius);
        }
        
        .footer-text {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .footer-link {
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 600;
        }
        
        .footer-link:hover {
            text-decoration: underline;
        }
        
        /* Print-specific styles */
        @media print {
            body * {
                visibility: hidden;
            }
            .preview-container, .preview-container * {
                visibility: visible;
            }
            .preview-container {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 0;
                margin: 0;
                box-shadow: none;
                border: none;
            }
            .cv-preview {
                padding: 20px;
            }
            .cv-header {
                box-shadow: none;
                border-radius: 0;
                margin-bottom: 20px;
            }
            .cv-section {
                page-break-inside: avoid;
            }
            .action-buttons, .form-container, header, .page-footer {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            .cv-contact {
                flex-direction: column;
                gap: 5px;
            }
        }
        
        .degree-suggestions {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
        }
        
        .status-message {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        #loadingOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
        }
        
        #loadingOverlay.show {
            display: flex;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Professional CV Generator</h1>
            <p class="tagline">Create an impressive CV in minutes - Indian format</p>
        </header>
        
        <div class="app-container">
            <div class="form-container">
                <!-- Personal Information -->
                <div class="section">
                    <div class="section-title">
                        <h2>Personal Information</h2>
                    </div>
                    
                    <div class="form-group">
                        <label for="fullName">Full Name</label>
                        <input type="text" id="fullName" placeholder="Rahul Sharma">
                    </div>
                    
                    <div class="form-group">
                        <label for="address">Address</label>
                        <input type="text" id="address" placeholder="Mumbai, Maharashtra">
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">Phone Number</label>
                        <input type="tel" id="phone" placeholder="+91 98765 43210">
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="rahul.sharma@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="summary">Professional Summary</label>
                        <textarea id="summary" placeholder="Brief description of your professional background, skills, and career goals..."></textarea>
                    </div>
                </div>
                
                <!-- Work Experience -->
                <div class="section">
                    <div class="section-title">
                        <h2>Work Experience</h2>
                        <button type="button" id="addExperience" class="btn-small">Add Experience</button>
                    </div>
                    
                    <div id="experienceContainer">
                        <!-- Experience items will be added here dynamically -->
                    </div>
                </div>
                
                <!-- Education -->
                <div class="section">
                    <div class="section-title">
                        <h2>Education</h2>
                    </div>
                    
                    <div class="form-group">
                        <label for="ssc">10th / SSC Details</label>
                        <input type="text" id="sscSchool" placeholder="School Name">
                        <input type="text" id="sscMarks" placeholder="Percentage/CGPA" style="margin-top: 8px;">
                        <input type="text" id="sscYear" placeholder="Passing Year" style="margin-top: 8px;">
                    </div>
                    
                    <div class="form-group">
                        <label for="hsc">12th / HSC Details</label>
                        <select id="hscStream" style="margin-bottom: 8px;">
                            <option value="">Select Stream</option>
                            <option value="Science">Science</option>
                            <option value="Commerce">Commerce</option>
                            <option value="Arts">Arts</option>
                        </select>
                        <input type="text" id="hscSchool" placeholder="School/College Name">
                        <input type="text" id="hscMarks" placeholder="Percentage/CGPA" style="margin-top: 8px;">
                        <input type="text" id="hscYear" placeholder="Passing Year" style="margin-top: 8px;">
                    </div>
                    
                    <div class="form-group">
                        <label for="graduation">Graduation Details</label>
                        <input type="text" id="gradDegree" placeholder="Degree (e.g., B.Tech, B.Com, B.Sc)" list="degreeSuggestions">
                        <datalist id="degreeSuggestions">
                            <option value="B.Tech (Computer Science)">
                            <option value="B.Tech (Mechanical Engineering)">
                            <option value="B.Tech (Electrical Engineering)">
                            <option value="B.Com">
                            <option value="B.Sc (Computer Science)">
                            <option value="B.Sc (Mathematics)">
                            <option value="B.Sc (Physics)">
                            <option value="BA (English)">
                            <option value="BA (Economics)">
                            <option value="BBA">
                            <option value="BCA">
                        </datalist>
                        <input type="text" id="gradCollege" placeholder="College/University Name" style="margin-top: 8px;">
                        <input type="text" id="gradMarks" placeholder="Percentage/CGPA" style="margin-top: 8px;">
                        <input type="text" id="gradYear" placeholder="Passing Year" style="margin-top: 8px;">
                    </div>
                    
                    <div class="form-group">
                        <label for="postGrad">Post Graduation Details (Optional)</label>
                        <input type="text" id="pgDegree" placeholder="Degree (e.g., M.Tech, MBA, M.Sc)" list="pgSuggestions">
                        <datalist id="pgSuggestions">
                            <option value="M.Tech">
                            <option value="MBA">
                            <option value="M.Sc">
                            <option value="MA">
                            <option value="MCA">
                            <option value="PGDM">
                        </datalist>
                        <input type="text" id="pgCollege" placeholder="College/University Name" style="margin-top: 8px;">
                        <input type="text" id="pgMarks" placeholder="Percentage/CGPA" style="margin-top: 8px;">
                        <input type="text" id="pgYear" placeholder="Passing Year" style="margin-top: 8px;">
                    </div>
                </div>
                
                <!-- Skills -->
                <div class="section">
                    <div class="section-title">
                        <h2>Skills</h2>
                    </div>
                    
                    <div class="form-group">
                        <label for="skills">Skills (comma separated)</label>
                        <input type="text" id="skills" placeholder="JavaScript, HTML, CSS, React, Node.js, Python">
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button type="button" id="saveCV" class="btn-success">Save CV</button>
                    <button type="button" id="printCV">Print CV</button>
                    <button type="button" id="exportPDF">Export as PDF</button>
                    <button type="button" id="sendCV">Send CV</button>
                </div>
                
                <div id="statusMessage" class="status-message" style="display: none;"></div>
            </div>
            
            <div class="preview-container">
                <h2 style="padding-left: 0; margin-bottom: 20px; text-align: center;">CV Preview</h2>
                <div id="cvPreview" class="cv-preview">
                    <!-- CV preview will be generated here -->
                </div>
            </div>
        </div>

        <!-- Page Footer (only for the generator, not in CV) -->
        <div class="page-footer">
            <p class="footer-text">Developed by Mrinal Kumar</p>
            <p class="footer-text">
                Connect with me on 
                <a href="https://www.linkedin.com/in/mrinal-kumar" target="_blank" class="footer-link">LinkedIn</a>
            </p>
        </div>
    </div>

    <div id="loadingOverlay">
        <div class="loading"></div>
        <p>Generating PDF...</p>
    </div>

    <script>
        // DOM Elements
        const fullNameInput = document.getElementById('fullName');
        const addressInput = document.getElementById('address');
        const phoneInput = document.getElementById('phone');
        const emailInput = document.getElementById('email');
        const summaryInput = document.getElementById('summary');
        const skillsInput = document.getElementById('skills');
        const experienceContainer = document.getElementById('experienceContainer');
        const cvPreview = document.getElementById('cvPreview');
        const addExperienceBtn = document.getElementById('addExperience');
        const saveCVBtn = document.getElementById('saveCV');
        const printCVBtn = document.getElementById('printCV');
        const exportPDFBtn = document.getElementById('exportPDF');
        const sendCVBtn = document.getElementById('sendCV');
        const statusMessage = document.getElementById('statusMessage');
        const loadingOverlay = document.getElementById('loadingOverlay');

        // Education elements
        const sscSchoolInput = document.getElementById('sscSchool');
        const sscMarksInput = document.getElementById('sscMarks');
        const sscYearInput = document.getElementById('sscYear');
        const hscStreamInput = document.getElementById('hscStream');
        const hscSchoolInput = document.getElementById('hscSchool');
        const hscMarksInput = document.getElementById('hscMarks');
        const hscYearInput = document.getElementById('hscYear');
        const gradDegreeInput = document.getElementById('gradDegree');
        const gradCollegeInput = document.getElementById('gradCollege');
        const gradMarksInput = document.getElementById('gradMarks');
        const gradYearInput = document.getElementById('gradYear');
        const pgDegreeInput = document.getElementById('pgDegree');
        const pgCollegeInput = document.getElementById('pgCollege');
        const pgMarksInput = document.getElementById('pgMarks');
        const pgYearInput = document.getElementById('pgYear');

        // Initialize with empty experience
        let experienceCount = 0;

        // Add event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Add first experience field
            addExperience();
            
            // Update preview when inputs change
            const inputs = document.querySelectorAll('input, textarea, select');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreview);
            });
            
            // Add experience button
            addExperienceBtn.addEventListener('click', addExperience);
            
            // Action buttons
            saveCVBtn.addEventListener('click', saveCV);
            printCVBtn.addEventListener('click', printCV);
            exportPDFBtn.addEventListener('click', exportPDF);
            sendCVBtn.addEventListener('click', sendCV);
            
            // Initial preview update
            updatePreview();
        });

        // Show status message
        function showStatus(message, type) {
            statusMessage.textContent = message;
            statusMessage.className = `status-message ${type}`;
            statusMessage.style.display = 'block';
            
            setTimeout(() => {
                statusMessage.style.display = 'none';
            }, 3000);
        }

        // Add experience field
        function addExperience() {
            experienceCount++;
            const experienceDiv = document.createElement('div');
            experienceDiv.className = 'experience-item';
            experienceDiv.innerHTML = `
                <div class="form-group">
                    <label for="experienceTitle${experienceCount}">Job Title</label>
                    <input type="text" id="experienceTitle${experienceCount}" placeholder="Software Developer">
                </div>
                <div class="form-group">
                    <label for="experienceCompany${experienceCount}">Company</label>
                    <input type="text" id="experienceCompany${experienceCount}" placeholder="Tech Company Inc.">
                </div>
                <div class="form-group">
                    <label for="experienceStartDate${experienceCount}">Start Date</label>
                    <input type="text" id="experienceStartDate${experienceCount}" placeholder="Jan 2020">
                </div>
                <div class="form-group">
                    <label for="experienceEndDate${experienceCount}">End Date</label>
                    <input type="text" id="experienceEndDate${experienceCount}" placeholder="Present">
                </div>
                <div class="form-group">
                    <label for="experienceDescription${experienceCount}">Description</label>
                    <textarea id="experienceDescription${experienceCount}" placeholder="Describe your responsibilities and achievements..."></textarea>
                </div>
                <button type="button" class="btn-danger btn-small remove-experience">Remove</button>
                <hr>
            `;
            experienceContainer.appendChild(experienceDiv);
            
            // Add event listener to the remove button
            const removeBtn = experienceDiv.querySelector('.remove-experience');
            removeBtn.addEventListener('click', function() {
                experienceContainer.removeChild(experienceDiv);
                updatePreview();
            });
            
            // Add event listeners to the new inputs
            const newInputs = experienceDiv.querySelectorAll('input, textarea');
            newInputs.forEach(input => {
                input.addEventListener('input', updatePreview);
            });
            
            updatePreview();
        }

        // Update CV preview
        function updatePreview() {
            // Personal Information
            const fullName = fullNameInput.value || 'Your Name';
            const address = addressInput.value || 'Your Address';
            const phone = phoneInput.value || '+91 98765 43210';
            const email = emailInput.value || 'your.email@example.com';
            const summary = summaryInput.value || 'Professional summary goes here...';
            
            // Skills
            const skills = skillsInput.value ? skillsInput.value.split(',').map(skill => skill.trim()) : [];
            
            // Experience
            const experienceItems = [];
            const experienceElements = document.querySelectorAll('.experience-item');
            experienceElements.forEach(item => {
                const title = item.querySelector('input[id^="experienceTitle"]').value;
                const company = item.querySelector('input[id^="experienceCompany"]').value;
                const startDate = item.querySelector('input[id^="experienceStartDate"]').value;
                const endDate = item.querySelector('input[id^="experienceEndDate"]').value;
                const description = item.querySelector('textarea[id^="experienceDescription"]').value;
                
                if (title || company) {
                    experienceItems.push({
                        title, company, startDate, endDate, description
                    });
                }
            });
            
            // Education
            const sscSchool = sscSchoolInput.value;
            const sscMarks = sscMarksInput.value;
            const sscYear = sscYearInput.value;
            
            const hscStream = hscStreamInput.value;
            const hscSchool = hscSchoolInput.value;
            const hscMarks = hscMarksInput.value;
            const hscYear = hscYearInput.value;
            
            const gradDegree = gradDegreeInput.value;
            const gradCollege = gradCollegeInput.value;
            const gradMarks = gradMarksInput.value;
            const gradYear = gradYearInput.value;
            
            const pgDegree = pgDegreeInput.value;
            const pgCollege = pgCollegeInput.value;
            const pgMarks = pgMarksInput.value;
            const pgYear = pgYearInput.value;
            
            // Generate HTML for preview
            let previewHTML = `
                <div class="cv-header">
                    <h1 class="cv-name">${fullName}</h1>
                    <div class="cv-contact">
                        <span>${address}</span>
                        <span>${phone}</span>
                        <span>${email}</span>
                    </div>
                </div>
                
                <div class="cv-section">
                    <h3 class="cv-section-title">Professional Summary</h3>
                    <p>${summary}</p>
                </div>
            `;
            
            // Experience section
            if (experienceItems.length > 0) {
                previewHTML += `
                    <div class="cv-section">
                        <h3 class="cv-section-title">Work Experience</h3>
                `;
                
                experienceItems.forEach(exp => {
                    previewHTML += `
                        <div class="cv-item">
                            <div class="cv-item-title">${exp.title || ''}</div>
                            <div class="cv-item-subtitle">${exp.company || ''}</div>
                            <div class="cv-item-date">${exp.startDate || ''} - ${exp.endDate || ''}</div>
                            <div class="cv-item-description">${exp.description || ''}</div>
                        </div>
                    `;
                });
                
                previewHTML += `</div>`;
            }
            
            // Education section
            previewHTML += `
                <div class="cv-section">
                    <h3 class="cv-section-title">Education</h3>
            `;
            
            // 10th/SSC
            if (sscSchool || sscMarks || sscYear) {
                previewHTML += `
                    <div class="cv-item">
                        <div class="cv-item-title">10th / SSC</div>
                        <div class="cv-item-subtitle">${sscSchool || ''} | ${sscMarks || ''} | ${sscYear || ''}</div>
                    </div>
                `;
            }
            
            // 12th/HSC
            if (hscSchool || hscMarks || hscYear) {
                const streamText = hscStream ? ` | ${hscStream}` : '';
                previewHTML += `
                    <div class="cv-item">
                        <div class="cv-item-title">12th / HSC</div>
                        <div class="cv-item-subtitle">${hscSchool || ''}${streamText} | ${hscMarks || ''} | ${hscYear || ''}</div>
                    </div>
                `;
            }
            
            // Graduation
            if (gradDegree || gradCollege || gradMarks || gradYear) {
                previewHTML += `
                    <div class="cv-item">
                        <div class="cv-item-title">${gradDegree || 'Graduation'}</div>
                        <div class="cv-item-subtitle">${gradCollege || ''} | ${gradMarks || ''} | ${gradYear || ''}</div>
                    </div>
                `;
            }
            
            // Post Graduation
            if (pgDegree || pgCollege || pgMarks || pgYear) {
                previewHTML += `
                    <div class="cv-item">
                        <div class="cv-item-title">${pgDegree || 'Post Graduation'}</div>
                        <div class="cv-item-subtitle">${pgCollege || ''} | ${pgMarks || ''} | ${pgYear || ''}</div>
                    </div>
                `;
            }
            
            previewHTML += `</div>`;
            
            // Skills section
            if (skills.length > 0) {
                previewHTML += `
                    <div class="cv-section">
                        <h3 class="cv-section-title">Skills</h3>
                        <div class="cv-skills">
                `;
                
                skills.forEach(skill => {
                    if (skill) {
                        previewHTML += `<span class="skill-tag">${skill}</span>`;
                    }
                });
                
                previewHTML += `
                        </div>
                    </div>
                `;
            }
            
            cvPreview.innerHTML = previewHTML;
        }

        // Save CV to localStorage
        function saveCV() {
            const cvData = {
                personal: {
                    fullName: fullNameInput.value,
                    address: addressInput.value,
                    phone: phoneInput.value,
                    email: emailInput.value,
                    summary: summaryInput.value
                },
                skills: skillsInput.value,
                education: {
                    ssc: {
                        school: sscSchoolInput.value,
                        marks: sscMarksInput.value,
                        year: sscYearInput.value
                    },
                    hsc: {
                        stream: hscStreamInput.value,
                        school: hscSchoolInput.value,
                        marks: hscMarksInput.value,
                        year: hscYearInput.value
                    },
                    graduation: {
                        degree: gradDegreeInput.value,
                        college: gradCollegeInput.value,
                        marks: gradMarksInput.value,
                        year: gradYearInput.value
                    },
                    postGraduation: {
                        degree: pgDegreeInput.value,
                        college: pgCollegeInput.value,
                        marks: pgMarksInput.value,
                        year: pgYearInput.value
                    }
                },
                experiences: []
            };
            
            // Collect experiences
            const experienceElements = document.querySelectorAll('.experience-item');
            experienceElements.forEach(item => {
                cvData.experiences.push({
                    title: item.querySelector('input[id^="experienceTitle"]').value,
                    company: item.querySelector('input[id^="experienceCompany"]').value,
                    startDate: item.querySelector('input[id^="experienceStartDate"]').value,
                    endDate: item.querySelector('input[id^="experienceEndDate"]').value,
                    description: item.querySelector('textarea[id^="experienceDescription"]').value
                });
            });
            
            localStorage.setItem('cvData', JSON.stringify(cvData));
            showStatus('CV saved successfully!', 'success');
        }

        // Print CV
        function printCV() {
            // First update preview to ensure we have latest content
            updatePreview();
            
            // Create a print-friendly version
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${fullNameInput.value || 'My CV'}</title>
                    <style>
                        body { 
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
                            color: #333; 
                            line-height: 1.6; 
                            max-width: 800px; 
                            margin: 0 auto; 
                            padding: 20px;
                        }
                        .cv-header { 
                            background: #2c3e50; 
                            color: white; 
                            padding: 30px; 
                            text-align: center; 
                            margin-bottom: 25px; 
                        }
                        .cv-name { 
                            font-size: 2.5rem; 
                            margin-bottom: 10px; 
                        }
                        .cv-contact { 
                            display: flex; 
                            justify-content: center; 
                            flex-wrap: wrap; 
                            gap: 20px; 
                            margin-top: 15px; 
                        }
                        .cv-section { 
                            margin-bottom: 25px; 
                        }
                        .cv-section-title { 
                            font-size: 1.4rem; 
                            color: #2c3e50; 
                            border-bottom: 2px solid #3498db; 
                            padding-bottom: 8px; 
                            margin-bottom: 15px; 
                        }
                        .cv-item { 
                            margin-bottom: 20px; 
                            padding-left: 20px; 
                            position: relative; 
                        }
                        .cv-item:before { 
                            content: "•"; 
                            color: #e74c3c; 
                            font-size: 1.5rem; 
                            position: absolute; 
                            left: 0; 
                            top: 0; 
                        }
                        .cv-item-title { 
                            font-weight: 600; 
                            font-size: 1.1rem; 
                            color: #34495e; 
                        }
                        .cv-item-subtitle { 
                            color: #666; 
                            margin-bottom: 5px; 
                            font-style: italic; 
                        }
                        .cv-item-date { 
                            color: #777; 
                            font-size: 0.9rem; 
                            margin-bottom: 8px; 
                        }
                        .cv-item-description { 
                            font-family: 'Georgia', serif; 
                            font-size: 0.95rem; 
                            color: #555; 
                        }
                        .cv-skills { 
                            display: flex; 
                            flex-wrap: wrap; 
                            gap: 10px; 
                            padding-left: 20px; 
                        }
                        .skill-tag { 
                            background: #3498db; 
                            color: white; 
                            padding: 8px 15px; 
                            border-radius: 20px; 
                            font-size: 0.9rem; 
                            position: relative; 
                            padding-left: 30px; 
                        }
                        .skill-tag:before { 
                            content: "✓"; 
                            position: absolute; 
                            left: 12px; 
                            top: 50%; 
                            transform: translateY(-50%); 
                            font-weight: bold; 
                        }
                        @media print { 
                            body { 
                                padding: 0; 
                            } 
                            .cv-section { 
                                page-break-inside: avoid; 
                            }
                        }
                    </style>
                </head>
                <body>
                    ${cvPreview.innerHTML}
                </body>
                </html>
            `);
            printWindow.document.close();
            
            // Wait for content to load then print
            printWindow.onload = function() {
                printWindow.print();
                printWindow.onafterprint = function() {
                    printWindow.close();
                };
            };
        }

        // Export as PDF - SIMPLIFIED AND FIXED
        function exportPDF() {
            // Show loading overlay
            loadingOverlay.classList.add('show');
            
            // Use html2canvas to capture the preview container directly
            html2canvas(cvPreview, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff'
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                
                // Create PDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const imgWidth = 210; // A4 width in mm
                const pageHeight = 295; // A4 height in mm
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                // Add image to PDF
                pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                
                // Download the PDF
                const fileName = (fullNameInput.value || 'CV').replace(/\s+/g, '_') + '_Professional_CV.pdf';
                pdf.save(fileName);
                
                // Hide loading overlay
                loadingOverlay.classList.remove('show');
                showStatus('PDF exported successfully!', 'success');
                
            }).catch(error => {
                console.error('Error generating PDF:', error);
                loadingOverlay.classList.remove('show');
                showStatus('Error generating PDF. Please try again.', 'error');
            });
        }

        // Send CV
        function sendCV() {
            showStatus('CV sharing feature would be implemented here!', 'success');
        }
    </script>
</body>
</html>
